{"id":"fpmC","dependencies":[{"name":"/Users/gokul/r/cityscope/cityscope_for_world/scanner/.babelrc","includedInParent":true,"mtime":1566133864000},{"name":"/Users/gokul/r/cityscope/cityscope_for_world/scanner/package.json","includedInParent":true,"mtime":1566217542247},{"name":"../Storage","loc":{"line":1,"column":7},"parent":"/Users/gokul/r/cityscope/cityscope_for_world/scanner/js/CV/CV.js","resolved":"/Users/gokul/r/cityscope/cityscope_for_world/scanner/js/Storage.js"},{"name":"../Modules","loc":{"line":2,"column":30},"parent":"/Users/gokul/r/cityscope/cityscope_for_world/scanner/js/CV/CV.js","resolved":"/Users/gokul/r/cityscope/cityscope_for_world/scanner/js/Modules.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.ColorPicker=e,exports.CV=t,require(\"../Storage\");var r=require(\"../Modules\");function e(){var e;(0,r.updateInfoDIV)(\"starting pixel scanner\");var a=function r(){for(var a=Storage.matrixGridLocArray,o=[],i=Storage.camCanvas.getContext(\"2d\").getImageData(0,0,window.innerWidth,window.innerHeight).data,n=0;n<a.length;n++){var l=4*(a[n][1]*innerWidth+a[n][0]);o.push([i[l-4],i[l-3],i[l-2],i[l],i[l+1],i[l+2],i[l+4],i[l+5],i[l+6]])}t(o),e=requestAnimationFrame(r)};return{start:function(){e=requestAnimationFrame(a)},cancel:function(){cancelAnimationFrame(e)}}}function t(r){for(var e,t,o=[],i=0;i<r.length;i++)t=(e=(.21*r[i][0]+.72*r[i][1]+.07*r[i][2]+(.21*r[i][3]+.72*r[i][4]+.07*r[i][5])+(.21*r[i][6]+.72*r[i][7]+.07*r[i][8]))/3)>133?0:e<123?1:2,o.push(t);Storage.pixelColArr=o,a()}function a(){if(JSON.stringify(Storage.old_pixel_Col_Array)!==JSON.stringify(Storage.pixelColArr)){Storage.old_pixel_Col_Array=Storage.pixelColArr;for(var r=Storage.old_pixel_Col_Array,e=[],t=0;t<r.length;t+=16){for(var a=[],o=0;o<16;o++)a.push(r[t+o]);a=a.join(\"\");var i=Storage.cityIOdataStruct.objects.codes.indexOf(a);e.push(i)}Storage.typesArray=e}}"},"sourceMaps":{"js":{"mappings":[{"source":"js/CV/CV.js","original":{"line":157,"column":1},"generated":{"line":1,"column":0}},{"source":"js/CV/CV.js","original":{"line":157,"column":1},"generated":{"line":1,"column":13}},{"source":"js/CV/CV.js","original":{"line":157,"column":1},"generated":{"line":1,"column":20}},{"source":"js/CV/CV.js","original":{"line":157,"column":1},"generated":{"line":1,"column":35}},{"source":"js/CV/CV.js","original":{"line":157,"column":1},"generated":{"line":1,"column":43}},{"source":"js/CV/CV.js","original":{"line":157,"column":1},"generated":{"line":1,"column":56}},{"source":"js/CV/CV.js","original":{"line":157,"column":1},"generated":{"line":1,"column":57}},{"source":"js/CV/CV.js","original":{"line":157,"column":1},"generated":{"line":1,"column":64}},{"source":"js/CV/CV.js","original":{"line":157,"column":1},"generated":{"line":1,"column":68}},{"source":"js/CV/CV.js","original":{"line":157,"column":1},"generated":{"line":1,"column":76}},{"source":"js/CV/CV.js","original":{"line":157,"column":1},"generated":{"line":1,"column":88}},{"source":"js/CV/CV.js","original":{"line":157,"column":1},"generated":{"line":1,"column":90}},{"source":"js/CV/CV.js","original":{"line":157,"column":1},"generated":{"line":1,"column":98}},{"source":"js/CV/CV.js","original":{"line":157,"column":1},"generated":{"line":1,"column":101}},{"source":"js/CV/CV.js","original":{"line":1,"column":0},"generated":{"line":1,"column":103}},{"source":"js/CV/CV.js","original":{"line":1,"column":0},"generated":{"line":1,"column":111}},{"source":"js/CV/CV.js","original":{"line":2,"column":0},"generated":{"line":1,"column":125}},{"source":"js/CV/CV.js","original":{"line":2,"column":0},"generated":{"line":1,"column":129}},{"source":"js/CV/CV.js","original":{"line":2,"column":0},"generated":{"line":1,"column":131}},{"source":"js/CV/CV.js","original":{"line":2,"column":0},"generated":{"line":1,"column":139}},{"source":"js/CV/CV.js","original":{"line":13,"column":7},"generated":{"line":1,"column":153}},{"source":"js/CV/CV.js","name":"ColorPicker","original":{"line":13,"column":16},"generated":{"line":1,"column":162}},{"source":"js/CV/CV.js","name":"timerID","original":{"line":16,"column":6},"generated":{"line":1,"column":166}},{"source":"js/CV/CV.js","name":"timerID","original":{"line":16,"column":6},"generated":{"line":1,"column":170}},{"source":"js/CV/CV.js","original":{"line":14,"column":16},"generated":{"line":1,"column":173}},{"source":"js/CV/CV.js","original":{"line":14,"column":16},"generated":{"line":1,"column":175}},{"source":"js/CV/CV.js","original":{"line":14,"column":16},"generated":{"line":1,"column":177}},{"source":"js/CV/CV.js","original":{"line":14,"column":16},"generated":{"line":1,"column":192}},{"source":"js/CV/CV.js","name":"scannerLoop","original":{"line":18,"column":6},"generated":{"line":1,"column":218}},{"source":"js/CV/CV.js","name":"scannerLoop","original":{"line":18,"column":6},"generated":{"line":1,"column":222}},{"source":"js/CV/CV.js","original":{"line":18,"column":20},"generated":{"line":1,"column":224}},{"source":"js/CV/CV.js","name":"scannerLoop","original":{"line":18,"column":6},"generated":{"line":1,"column":233}},{"source":"js/CV/CV.js","original":{"line":33,"column":9},"generated":{"line":1,"column":237}},{"source":"js/CV/CV.js","name":"matrixGridLocArray","original":{"line":19,"column":8},"generated":{"line":1,"column":241}},{"source":"js/CV/CV.js","name":"matrixGridLocArray","original":{"line":19,"column":8},"generated":{"line":1,"column":245}},{"source":"js/CV/CV.js","name":"Storage","original":{"line":19,"column":29},"generated":{"line":1,"column":247}},{"source":"js/CV/CV.js","name":"matrixGridLocArray","original":{"line":19,"column":37},"generated":{"line":1,"column":255}},{"source":"js/CV/CV.js","name":"scannedColorsArray","original":{"line":22,"column":8},"generated":{"line":1,"column":274}},{"source":"js/CV/CV.js","original":{"line":22,"column":29},"generated":{"line":1,"column":276}},{"source":"js/CV/CV.js","name":"canvasData","original":{"line":32,"column":8},"generated":{"line":1,"column":279}},{"source":"js/CV/CV.js","name":"Storage","original":{"line":24,"column":29},"generated":{"line":1,"column":281}},{"source":"js/CV/CV.js","name":"camCanvas","original":{"line":24,"column":37},"generated":{"line":1,"column":289}},{"source":"js/CV/CV.js","name":"getContext","original":{"line":24,"column":47},"generated":{"line":1,"column":299}},{"source":"js/CV/CV.js","original":{"line":24,"column":58},"generated":{"line":1,"column":310}},{"source":"js/CV/CV.js","name":"getImageData","original":{"line":25,"column":42},"generated":{"line":1,"column":316}},{"source":"js/CV/CV.js","original":{"line":26,"column":6},"generated":{"line":1,"column":329}},{"source":"js/CV/CV.js","original":{"line":27,"column":6},"generated":{"line":1,"column":331}},{"source":"js/CV/CV.js","name":"window","original":{"line":28,"column":6},"generated":{"line":1,"column":333}},{"source":"js/CV/CV.js","name":"innerWidth","original":{"line":28,"column":13},"generated":{"line":1,"column":340}},{"source":"js/CV/CV.js","name":"window","original":{"line":29,"column":6},"generated":{"line":1,"column":351}},{"source":"js/CV/CV.js","name":"innerHeight","original":{"line":29,"column":13},"generated":{"line":1,"column":358}},{"source":"js/CV/CV.js","name":"data","original":{"line":32,"column":34},"generated":{"line":1,"column":371}},{"source":"js/CV/CV.js","name":"i","original":{"line":33,"column":13},"generated":{"line":1,"column":376}},{"source":"js/CV/CV.js","original":{"line":33,"column":17},"generated":{"line":1,"column":378}},{"source":"js/CV/CV.js","name":"i","original":{"line":33,"column":20},"generated":{"line":1,"column":380}},{"source":"js/CV/CV.js","name":"matrixGridLocArray","original":{"line":33,"column":24},"generated":{"line":1,"column":382}},{"source":"js/CV/CV.js","name":"length","original":{"line":33,"column":43},"generated":{"line":1,"column":384}},{"source":"js/CV/CV.js","name":"i","original":{"line":33,"column":51},"generated":{"line":1,"column":391}},{"source":"js/CV/CV.js","original":{"line":33,"column":56},"generated":{"line":1,"column":395}},{"source":"js/CV/CV.js","name":"pixLoc","original":{"line":34,"column":10},"generated":{"line":1,"column":396}},{"source":"js/CV/CV.js","name":"pixLoc","original":{"line":34,"column":10},"generated":{"line":1,"column":400}},{"source":"js/CV/CV.js","original":{"line":35,"column":77},"generated":{"line":1,"column":402}},{"source":"js/CV/CV.js","name":"matrixGridLocArray","original":{"line":35,"column":9},"generated":{"line":1,"column":405}},{"source":"js/CV/CV.js","name":"i","original":{"line":35,"column":28},"generated":{"line":1,"column":407}},{"source":"js/CV/CV.js","original":{"line":35,"column":31},"generated":{"line":1,"column":410}},{"source":"js/CV/CV.js","name":"innerWidth","original":{"line":35,"column":36},"generated":{"line":1,"column":413}},{"source":"js/CV/CV.js","name":"matrixGridLocArray","original":{"line":35,"column":49},"generated":{"line":1,"column":424}},{"source":"js/CV/CV.js","name":"i","original":{"line":35,"column":68},"generated":{"line":1,"column":426}},{"source":"js/CV/CV.js","original":{"line":35,"column":71},"generated":{"line":1,"column":429}},{"source":"js/CV/CV.js","name":"scannedColorsArray","original":{"line":37,"column":6},"generated":{"line":1,"column":433}},{"source":"js/CV/CV.js","name":"push","original":{"line":37,"column":25},"generated":{"line":1,"column":435}},{"source":"js/CV/CV.js","name":"canvasData","original":{"line":40,"column":10},"generated":{"line":1,"column":440}},{"source":"js/CV/CV.js","name":"canvasData","original":{"line":40,"column":10},"generated":{"line":1,"column":441}},{"source":"js/CV/CV.js","name":"pixLoc","original":{"line":40,"column":21},"generated":{"line":1,"column":443}},{"source":"js/CV/CV.js","original":{"line":40,"column":30},"generated":{"line":1,"column":445}},{"source":"js/CV/CV.js","name":"canvasData","original":{"line":41,"column":10},"generated":{"line":1,"column":448}},{"source":"js/CV/CV.js","name":"pixLoc","original":{"line":41,"column":21},"generated":{"line":1,"column":450}},{"source":"js/CV/CV.js","original":{"line":41,"column":30},"generated":{"line":1,"column":452}},{"source":"js/CV/CV.js","name":"canvasData","original":{"line":42,"column":10},"generated":{"line":1,"column":455}},{"source":"js/CV/CV.js","name":"pixLoc","original":{"line":42,"column":21},"generated":{"line":1,"column":457}},{"source":"js/CV/CV.js","original":{"line":42,"column":30},"generated":{"line":1,"column":459}},{"source":"js/CV/CV.js","name":"canvasData","original":{"line":44,"column":10},"generated":{"line":1,"column":462}},{"source":"js/CV/CV.js","name":"pixLoc","original":{"line":44,"column":21},"generated":{"line":1,"column":464}},{"source":"js/CV/CV.js","name":"canvasData","original":{"line":45,"column":10},"generated":{"line":1,"column":467}},{"source":"js/CV/CV.js","name":"pixLoc","original":{"line":45,"column":21},"generated":{"line":1,"column":469}},{"source":"js/CV/CV.js","original":{"line":45,"column":30},"generated":{"line":1,"column":471}},{"source":"js/CV/CV.js","name":"canvasData","original":{"line":46,"column":10},"generated":{"line":1,"column":474}},{"source":"js/CV/CV.js","name":"pixLoc","original":{"line":46,"column":21},"generated":{"line":1,"column":476}},{"source":"js/CV/CV.js","original":{"line":46,"column":30},"generated":{"line":1,"column":478}},{"source":"js/CV/CV.js","name":"canvasData","original":{"line":48,"column":10},"generated":{"line":1,"column":481}},{"source":"js/CV/CV.js","name":"pixLoc","original":{"line":48,"column":21},"generated":{"line":1,"column":483}},{"source":"js/CV/CV.js","original":{"line":48,"column":30},"generated":{"line":1,"column":485}},{"source":"js/CV/CV.js","name":"canvasData","original":{"line":49,"column":10},"generated":{"line":1,"column":488}},{"source":"js/CV/CV.js","name":"pixLoc","original":{"line":49,"column":21},"generated":{"line":1,"column":490}},{"source":"js/CV/CV.js","original":{"line":49,"column":30},"generated":{"line":1,"column":492}},{"source":"js/CV/CV.js","name":"canvasData","original":{"line":50,"column":10},"generated":{"line":1,"column":495}},{"source":"js/CV/CV.js","name":"pixLoc","original":{"line":50,"column":21},"generated":{"line":1,"column":497}},{"source":"js/CV/CV.js","original":{"line":50,"column":30},"generated":{"line":1,"column":499}},{"source":"js/CV/CV.js","name":"CV","original":{"line":56,"column":4},"generated":{"line":1,"column":504}},{"source":"js/CV/CV.js","name":"scannedColorsArray","original":{"line":56,"column":7},"generated":{"line":1,"column":506}},{"source":"js/CV/CV.js","name":"timerID","original":{"line":59,"column":4},"generated":{"line":1,"column":509}},{"source":"js/CV/CV.js","name":"requestAnimationFrame","original":{"line":59,"column":14},"generated":{"line":1,"column":511}},{"source":"js/CV/CV.js","name":"scannerLoop","original":{"line":59,"column":36},"generated":{"line":1,"column":533}},{"source":"js/CV/CV.js","original":{"line":63,"column":9},"generated":{"line":1,"column":537}},{"source":"js/CV/CV.js","original":{"line":63,"column":9},"generated":{"line":1,"column":543}},{"source":"js/CV/CV.js","name":"start","original":{"line":64,"column":4},"generated":{"line":1,"column":544}},{"source":"js/CV/CV.js","original":{"line":64,"column":11},"generated":{"line":1,"column":550}},{"source":"js/CV/CV.js","name":"timerID","original":{"line":65,"column":6},"generated":{"line":1,"column":561}},{"source":"js/CV/CV.js","name":"requestAnimationFrame","original":{"line":65,"column":16},"generated":{"line":1,"column":563}},{"source":"js/CV/CV.js","name":"scannerLoop","original":{"line":65,"column":38},"generated":{"line":1,"column":585}},{"source":"js/CV/CV.js","name":"cancel","original":{"line":67,"column":4},"generated":{"line":1,"column":589}},{"source":"js/CV/CV.js","original":{"line":67,"column":12},"generated":{"line":1,"column":596}},{"source":"js/CV/CV.js","name":"cancelAnimationFrame","original":{"line":68,"column":6},"generated":{"line":1,"column":607}},{"source":"js/CV/CV.js","name":"timerID","original":{"line":68,"column":27},"generated":{"line":1,"column":628}},{"source":"js/CV/CV.js","original":{"line":75,"column":7},"generated":{"line":1,"column":633}},{"source":"js/CV/CV.js","name":"CV","original":{"line":75,"column":16},"generated":{"line":1,"column":642}},{"source":"js/CV/CV.js","name":"scannedPixels","original":{"line":75,"column":19},"generated":{"line":1,"column":644}},{"source":"js/CV/CV.js","original":{"line":84,"column":7},"generated":{"line":1,"column":647}},{"source":"js/CV/CV.js","name":"threshold","original":{"line":78,"column":6},"generated":{"line":1,"column":651}},{"source":"js/CV/CV.js","name":"avg","original":{"line":79,"column":6},"generated":{"line":1,"column":655}},{"source":"js/CV/CV.js","name":"pixelCol","original":{"line":79,"column":32},"generated":{"line":1,"column":657}},{"source":"js/CV/CV.js","name":"pixelColorArray","original":{"line":81,"column":6},"generated":{"line":1,"column":659}},{"source":"js/CV/CV.js","original":{"line":81,"column":24},"generated":{"line":1,"column":661}},{"source":"js/CV/CV.js","name":"i","original":{"line":84,"column":11},"generated":{"line":1,"column":664}},{"source":"js/CV/CV.js","original":{"line":84,"column":15},"generated":{"line":1,"column":666}},{"source":"js/CV/CV.js","name":"i","original":{"line":84,"column":18},"generated":{"line":1,"column":668}},{"source":"js/CV/CV.js","name":"scannedPixels","original":{"line":84,"column":22},"generated":{"line":1,"column":670}},{"source":"js/CV/CV.js","name":"length","original":{"line":84,"column":36},"generated":{"line":1,"column":672}},{"source":"js/CV/CV.js","name":"i","original":{"line":84,"column":44},"generated":{"line":1,"column":679}},{"source":"js/CV/CV.js","name":"pixelCol","original":{"line":103,"column":6},"generated":{"line":1,"column":683}},{"source":"js/CV/CV.js","name":"avg","original":{"line":98,"column":4},"generated":{"line":1,"column":686}},{"source":"js/CV/CV.js","original":{"line":86,"column":6},"generated":{"line":1,"column":689}},{"source":"js/CV/CV.js","name":"scannedPixels","original":{"line":86,"column":13},"generated":{"line":1,"column":693}},{"source":"js/CV/CV.js","name":"i","original":{"line":86,"column":27},"generated":{"line":1,"column":695}},{"source":"js/CV/CV.js","original":{"line":86,"column":30},"generated":{"line":1,"column":698}},{"source":"js/CV/CV.js","original":{"line":87,"column":6},"generated":{"line":1,"column":701}},{"source":"js/CV/CV.js","name":"scannedPixels","original":{"line":87,"column":13},"generated":{"line":1,"column":705}},{"source":"js/CV/CV.js","name":"i","original":{"line":87,"column":27},"generated":{"line":1,"column":707}},{"source":"js/CV/CV.js","original":{"line":87,"column":30},"generated":{"line":1,"column":710}},{"source":"js/CV/CV.js","original":{"line":88,"column":6},"generated":{"line":1,"column":713}},{"source":"js/CV/CV.js","name":"scannedPixels","original":{"line":88,"column":13},"generated":{"line":1,"column":717}},{"source":"js/CV/CV.js","name":"i","original":{"line":88,"column":27},"generated":{"line":1,"column":719}},{"source":"js/CV/CV.js","original":{"line":88,"column":30},"generated":{"line":1,"column":722}},{"source":"js/CV/CV.js","original":{"line":90,"column":6},"generated":{"line":1,"column":726}},{"source":"js/CV/CV.js","name":"scannedPixels","original":{"line":90,"column":13},"generated":{"line":1,"column":730}},{"source":"js/CV/CV.js","name":"i","original":{"line":90,"column":27},"generated":{"line":1,"column":732}},{"source":"js/CV/CV.js","original":{"line":90,"column":30},"generated":{"line":1,"column":735}},{"source":"js/CV/CV.js","original":{"line":91,"column":6},"generated":{"line":1,"column":738}},{"source":"js/CV/CV.js","name":"scannedPixels","original":{"line":91,"column":13},"generated":{"line":1,"column":742}},{"source":"js/CV/CV.js","name":"i","original":{"line":91,"column":27},"generated":{"line":1,"column":744}},{"source":"js/CV/CV.js","original":{"line":91,"column":30},"generated":{"line":1,"column":747}},{"source":"js/CV/CV.js","original":{"line":92,"column":6},"generated":{"line":1,"column":750}},{"source":"js/CV/CV.js","name":"scannedPixels","original":{"line":92,"column":13},"generated":{"line":1,"column":754}},{"source":"js/CV/CV.js","name":"i","original":{"line":92,"column":27},"generated":{"line":1,"column":756}},{"source":"js/CV/CV.js","original":{"line":92,"column":30},"generated":{"line":1,"column":759}},{"source":"js/CV/CV.js","original":{"line":94,"column":6},"generated":{"line":1,"column":764}},{"source":"js/CV/CV.js","name":"scannedPixels","original":{"line":94,"column":13},"generated":{"line":1,"column":768}},{"source":"js/CV/CV.js","name":"i","original":{"line":94,"column":27},"generated":{"line":1,"column":770}},{"source":"js/CV/CV.js","original":{"line":94,"column":30},"generated":{"line":1,"column":773}},{"source":"js/CV/CV.js","original":{"line":95,"column":6},"generated":{"line":1,"column":776}},{"source":"js/CV/CV.js","name":"scannedPixels","original":{"line":95,"column":13},"generated":{"line":1,"column":780}},{"source":"js/CV/CV.js","name":"i","original":{"line":95,"column":27},"generated":{"line":1,"column":782}},{"source":"js/CV/CV.js","original":{"line":95,"column":30},"generated":{"line":1,"column":785}},{"source":"js/CV/CV.js","original":{"line":96,"column":6},"generated":{"line":1,"column":788}},{"source":"js/CV/CV.js","name":"scannedPixels","original":{"line":96,"column":13},"generated":{"line":1,"column":792}},{"source":"js/CV/CV.js","name":"i","original":{"line":96,"column":27},"generated":{"line":1,"column":794}},{"source":"js/CV/CV.js","original":{"line":96,"column":30},"generated":{"line":1,"column":797}},{"source":"js/CV/CV.js","original":{"line":98,"column":36},"generated":{"line":1,"column":802}},{"source":"js/CV/CV.js","original":{"line":101,"column":14},"generated":{"line":1,"column":805}},{"source":"js/CV/CV.js","original":{"line":103,"column":17},"generated":{"line":1,"column":809}},{"source":"js/CV/CV.js","name":"avg","original":{"line":104,"column":15},"generated":{"line":1,"column":811}},{"source":"js/CV/CV.js","original":{"line":104,"column":21},"generated":{"line":1,"column":813}},{"source":"js/CV/CV.js","original":{"line":106,"column":17},"generated":{"line":1,"column":817}},{"source":"js/CV/CV.js","original":{"line":109,"column":17},"generated":{"line":1,"column":819}},{"source":"js/CV/CV.js","name":"pixelColorArray","original":{"line":111,"column":4},"generated":{"line":1,"column":821}},{"source":"js/CV/CV.js","name":"push","original":{"line":111,"column":20},"generated":{"line":1,"column":823}},{"source":"js/CV/CV.js","name":"pixelCol","original":{"line":111,"column":25},"generated":{"line":1,"column":828}},{"source":"js/CV/CV.js","name":"Storage","original":{"line":114,"column":2},"generated":{"line":1,"column":831}},{"source":"js/CV/CV.js","name":"pixelColArr","original":{"line":114,"column":10},"generated":{"line":1,"column":839}},{"source":"js/CV/CV.js","name":"pixelColorArray","original":{"line":114,"column":24},"generated":{"line":1,"column":851}},{"source":"js/CV/CV.js","name":"typesLookup","original":{"line":115,"column":2},"generated":{"line":1,"column":853}},{"source":"js/CV/CV.js","original":{"line":126,"column":0},"generated":{"line":1,"column":857}},{"source":"js/CV/CV.js","name":"typesLookup","original":{"line":126,"column":9},"generated":{"line":1,"column":866}},{"source":"js/CV/CV.js","name":"JSON","original":{"line":130,"column":4},"generated":{"line":1,"column":870}},{"source":"js/CV/CV.js","name":"JSON","original":{"line":130,"column":4},"generated":{"line":1,"column":873}},{"source":"js/CV/CV.js","name":"stringify","original":{"line":130,"column":9},"generated":{"line":1,"column":878}},{"source":"js/CV/CV.js","name":"Storage","original":{"line":130,"column":19},"generated":{"line":1,"column":888}},{"source":"js/CV/CV.js","name":"old_pixel_Col_Array","original":{"line":130,"column":27},"generated":{"line":1,"column":896}},{"source":"js/CV/CV.js","name":"JSON","original":{"line":131,"column":4},"generated":{"line":1,"column":919}},{"source":"js/CV/CV.js","name":"stringify","original":{"line":131,"column":9},"generated":{"line":1,"column":924}},{"source":"js/CV/CV.js","name":"Storage","original":{"line":131,"column":19},"generated":{"line":1,"column":934}},{"source":"js/CV/CV.js","name":"pixelColArr","original":{"line":131,"column":27},"generated":{"line":1,"column":942}},{"source":"js/CV/CV.js","name":"JSON","original":{"line":130,"column":4},"generated":{"line":1,"column":955}},{"source":"js/CV/CV.js","name":"Storage","original":{"line":133,"column":4},"generated":{"line":1,"column":956}},{"source":"js/CV/CV.js","name":"old_pixel_Col_Array","original":{"line":133,"column":12},"generated":{"line":1,"column":964}},{"source":"js/CV/CV.js","name":"Storage","original":{"line":133,"column":34},"generated":{"line":1,"column":984}},{"source":"js/CV/CV.js","name":"pixelColArr","original":{"line":133,"column":42},"generated":{"line":1,"column":992}},{"source":"js/CV/CV.js","original":{"line":138,"column":9},"generated":{"line":1,"column":1004}},{"source":"js/CV/CV.js","name":"pixelColorArray","original":{"line":135,"column":8},"generated":{"line":1,"column":1008}},{"source":"js/CV/CV.js","name":"pixelColorArray","original":{"line":135,"column":8},"generated":{"line":1,"column":1012}},{"source":"js/CV/CV.js","name":"Storage","original":{"line":135,"column":26},"generated":{"line":1,"column":1014}},{"source":"js/CV/CV.js","name":"old_pixel_Col_Array","original":{"line":135,"column":34},"generated":{"line":1,"column":1022}},{"source":"js/CV/CV.js","name":"typesArray","original":{"line":137,"column":8},"generated":{"line":1,"column":1042}},{"source":"js/CV/CV.js","original":{"line":137,"column":21},"generated":{"line":1,"column":1044}},{"source":"js/CV/CV.js","name":"i","original":{"line":138,"column":13},"generated":{"line":1,"column":1047}},{"source":"js/CV/CV.js","original":{"line":138,"column":17},"generated":{"line":1,"column":1049}},{"source":"js/CV/CV.js","name":"i","original":{"line":138,"column":20},"generated":{"line":1,"column":1051}},{"source":"js/CV/CV.js","name":"pixelColorArray","original":{"line":138,"column":24},"generated":{"line":1,"column":1053}},{"source":"js/CV/CV.js","name":"length","original":{"line":138,"column":40},"generated":{"line":1,"column":1055}},{"source":"js/CV/CV.js","name":"i","original":{"line":138,"column":48},"generated":{"line":1,"column":1062}},{"source":"js/CV/CV.js","original":{"line":138,"column":56},"generated":{"line":1,"column":1065}},{"source":"js/CV/CV.js","original":{"line":138,"column":60},"generated":{"line":1,"column":1068}},{"source":"js/CV/CV.js","original":{"line":140,"column":11},"generated":{"line":1,"column":1069}},{"source":"js/CV/CV.js","name":"thisBrick","original":{"line":139,"column":10},"generated":{"line":1,"column":1073}},{"source":"js/CV/CV.js","name":"thisBrick","original":{"line":139,"column":10},"generated":{"line":1,"column":1077}},{"source":"js/CV/CV.js","original":{"line":139,"column":22},"generated":{"line":1,"column":1079}},{"source":"js/CV/CV.js","name":"j","original":{"line":140,"column":15},"generated":{"line":1,"column":1082}},{"source":"js/CV/CV.js","original":{"line":140,"column":19},"generated":{"line":1,"column":1084}},{"source":"js/CV/CV.js","name":"j","original":{"line":140,"column":22},"generated":{"line":1,"column":1086}},{"source":"js/CV/CV.js","original":{"line":140,"column":26},"generated":{"line":1,"column":1088}},{"source":"js/CV/CV.js","name":"j","original":{"line":140,"column":30},"generated":{"line":1,"column":1091}},{"source":"js/CV/CV.js","name":"thisBrick","original":{"line":141,"column":8},"generated":{"line":1,"column":1095}},{"source":"js/CV/CV.js","name":"push","original":{"line":141,"column":18},"generated":{"line":1,"column":1097}},{"source":"js/CV/CV.js","name":"pixelColorArray","original":{"line":141,"column":23},"generated":{"line":1,"column":1102}},{"source":"js/CV/CV.js","name":"i","original":{"line":141,"column":39},"generated":{"line":1,"column":1104}},{"source":"js/CV/CV.js","name":"j","original":{"line":141,"column":43},"generated":{"line":1,"column":1106}},{"source":"js/CV/CV.js","name":"thisBrick","original":{"line":144,"column":6},"generated":{"line":1,"column":1110}},{"source":"js/CV/CV.js","name":"thisBrick","original":{"line":144,"column":18},"generated":{"line":1,"column":1112}},{"source":"js/CV/CV.js","name":"join","original":{"line":144,"column":28},"generated":{"line":1,"column":1114}},{"source":"js/CV/CV.js","original":{"line":144,"column":33},"generated":{"line":1,"column":1119}},{"source":"js/CV/CV.js","name":"indexCode","original":{"line":147,"column":10},"generated":{"line":1,"column":1123}},{"source":"js/CV/CV.js","name":"indexCode","original":{"line":147,"column":10},"generated":{"line":1,"column":1127}},{"source":"js/CV/CV.js","name":"Storage","original":{"line":147,"column":22},"generated":{"line":1,"column":1129}},{"source":"js/CV/CV.js","name":"cityIOdataStruct","original":{"line":147,"column":30},"generated":{"line":1,"column":1137}},{"source":"js/CV/CV.js","name":"objects","original":{"line":147,"column":47},"generated":{"line":1,"column":1154}},{"source":"js/CV/CV.js","name":"codes","original":{"line":147,"column":55},"generated":{"line":1,"column":1162}},{"source":"js/CV/CV.js","name":"indexOf","original":{"line":147,"column":61},"generated":{"line":1,"column":1168}},{"source":"js/CV/CV.js","name":"thisBrick","original":{"line":147,"column":69},"generated":{"line":1,"column":1176}},{"source":"js/CV/CV.js","name":"typesArray","original":{"line":148,"column":6},"generated":{"line":1,"column":1179}},{"source":"js/CV/CV.js","name":"push","original":{"line":148,"column":17},"generated":{"line":1,"column":1181}},{"source":"js/CV/CV.js","name":"indexCode","original":{"line":148,"column":22},"generated":{"line":1,"column":1186}},{"source":"js/CV/CV.js","name":"Storage","original":{"line":151,"column":4},"generated":{"line":1,"column":1189}},{"source":"js/CV/CV.js","name":"typesArray","original":{"line":151,"column":12},"generated":{"line":1,"column":1197}},{"source":"js/CV/CV.js","name":"typesArray","original":{"line":151,"column":25},"generated":{"line":1,"column":1208}}],"sources":{"js/CV/CV.js":"import \"../Storage\";\nimport { updateInfoDIV } from \"../Modules\";\n\n///////////////////////////////////////////////////////////////////////////\n/*    \nget the pixel location at the center of the grid cell div\nand match it to the pixel location in the PixelBuffer linear list\ncall a looping method that scans the grid\n[this is a hack, so this function could be called\nusing 'requestAnimationFrame' API]\n*/\n\nexport function ColorPicker() {\n  updateInfoDIV(\"starting pixel scanner\");\n  //gets the animation frame\n  var timerID;\n\n  var scannerLoop = function() {\n    var matrixGridLocArray = Storage.matrixGridLocArray;\n\n    // empty color array\n    let scannedColorsArray = [];\n    // read all pixels from canvas\n    let vidCanvas2dContext = Storage.camCanvas.getContext(\"2d\");\n    let canvasPixels = vidCanvas2dContext.getImageData(\n      0,\n      0,\n      window.innerWidth,\n      window.innerHeight\n    );\n    //get the pixels\n    let canvasData = canvasPixels.data;\n    for (let i = 0; i < matrixGridLocArray.length; i++) {\n      let pixLoc =\n        (matrixGridLocArray[i][1] * innerWidth + matrixGridLocArray[i][0]) * 4;\n      // sample and push to array 3 pixels around to get better recognition\n      scannedColorsArray.push(\n        //pixel before\n        [\n          canvasData[pixLoc - 4],\n          canvasData[pixLoc - 3],\n          canvasData[pixLoc - 2],\n          //this  pixel\n          canvasData[pixLoc],\n          canvasData[pixLoc + 1],\n          canvasData[pixLoc + 2],\n          //next pixel\n          canvasData[pixLoc + 4],\n          canvasData[pixLoc + 5],\n          canvasData[pixLoc + 6]\n        ]\n      );\n    }\n\n    // call the CV method for color analysis\n    CV(scannedColorsArray);\n\n    //recursively call this method every frame\n    timerID = requestAnimationFrame(scannerLoop);\n  };\n\n  //controllers\n  return {\n    start: function() {\n      timerID = requestAnimationFrame(scannerLoop);\n    },\n    cancel: function() {\n      cancelAnimationFrame(timerID);\n    }\n  };\n}\n\n///////////////////////////////////////////////////////////////////////////\n//do CV on image data\nexport function CV(scannedPixels) {\n  //set threshold for unclear color\n  // between black and white\n  let threshold = 5;\n  let avg, avg_0, avg_1, avg_2, pixelCol;\n  //reset array\n  let pixelColorArray = [];\n\n  //sample 3 pixels [3x3 colors] each time\n  for (let i = 0; i < scannedPixels.length; i++) {\n    avg_0 =\n      0.21 * scannedPixels[i][0] +\n      0.72 * scannedPixels[i][1] +\n      0.07 * scannedPixels[i][2];\n    avg_1 =\n      0.21 * scannedPixels[i][3] +\n      0.72 * scannedPixels[i][4] +\n      0.07 * scannedPixels[i][5];\n    avg_2 =\n      0.21 * scannedPixels[i][6] +\n      0.72 * scannedPixels[i][7] +\n      0.07 * scannedPixels[i][8];\n\n    avg = (avg_0 + avg_1 + avg_2) / 3;\n    // decide if pixel color should be black or white\n    //based on avg function\n    if (avg > 256 / 2 + threshold) {\n      //black\n      pixelCol = 0;\n    } else if (avg < 256 / 2 - threshold) {\n      //white\n      pixelCol = 1;\n    } else {\n      //3rd color\n      pixelCol = 2;\n    }\n    pixelColorArray.push(pixelCol);\n  }\n  //save to storage for render method\n  Storage.pixelColArr = pixelColorArray;\n  typesLookup();\n}\n\n///////////////////////////////////////////////////////////////////////////\n//send back the location of this type in the types list\n// 1. the type found in cv\n// 2. colors for  visualization & cityIO sending\n// find this brick's type using the found color info\n// by matching the 16[4x4] pixels to known types\n// by running through the 1D list of colors\n\nfunction typesLookup() {\n  //check for new color pixels array every frame.\n  //if exist, look for new types and produce typesArray[]\n  if (\n    JSON.stringify(Storage.old_pixel_Col_Array) !==\n    JSON.stringify(Storage.pixelColArr)\n  ) {\n    Storage.old_pixel_Col_Array = Storage.pixelColArr;\n    //get pixels colors array from storage\n    let pixelColorArray = Storage.old_pixel_Col_Array;\n\n    let typesArray = [];\n    for (let i = 0; i < pixelColorArray.length; i = i + 16) {\n      let thisBrick = [];\n      for (let j = 0; j < 16; j++) {\n        thisBrick.push(pixelColorArray[i + j]);\n      }\n      //remove new lines and commas to get a clear list\n      thisBrick = thisBrick.join(\"\");\n\n      //look for this bricks pattern in 'Codes' prop\n      let indexCode = Storage.cityIOdataStruct.objects.codes.indexOf(thisBrick);\n      typesArray.push(indexCode);\n    }\n    //save types array to global storage\n    Storage.typesArray = typesArray;\n\n    //if no new colors array exist, skip this method\n  } else {\n    return;\n  }\n}\n"},"lineCount":null}},"error":null,"hash":"c58b6c09efb6f17badd685a0b0c5799f","cacheData":{"env":{}}}